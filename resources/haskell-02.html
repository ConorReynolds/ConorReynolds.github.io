<!DOCTYPE html>
<html lang="en-gb">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    Haskell Assignment Sheet 2 | Conor Reynolds
  </title>

  <meta name="robots" content="noindex,nofollow">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css" integrity="sha384-bYdxxUwYipFNohQlHt0bjN/LCpueqWz13HufFEV1SUatKs1cm4L6fFgCi1jT643X" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.js" integrity="sha384-Qsn9KnoKISj6dI8g7p1HBlNpVx0I8p1SvlwOldgi3IorMle61nQy4zEahWYtljaz" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
  <script>
      document.addEventListener("DOMContentLoaded", function() {
          renderMathInElement(document.body, {
              // customised options
              // • auto-render specific keys, e.g.:
              delimiters: [
                  {left: '$$', right: '$$', display: true},
                  {left: '$', right: '$', display: false},
                  {left: '\\(', right: '\\)', display: false},
                  {left: '\\[', right: '\\]', display: true}
              ],
              // • rendering keys, e.g.:
              throwOnError : false
          });
      });
  </script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous">

  <link rel="preload" href="/fonts/SourceCodePro/SourceCodePro-Bold.otf.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/SourceCodePro/SourceCodePro-BoldIt.otf.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/SourceCodePro/SourceCodePro-Medium.otf.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/SourceCodePro/SourceCodePro-MediumIt.otf.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="stylesheet" type="text/css" href="/main.css" />

  <!--
    Does nothing, but prevents flash of unstyled content in Firefox.
    Thanks: https://stackoverflow.com/a/64158043
  -->
  <script>
  let fix_FOUC_in_firefox;
  </script>
</head>

<body><div class="header" data-pagetype="post"><div id="title-block">
<h1>Haskell Assignment Sheet 2</h1>
<div class="subtitle">Data, types, and typeclasses</div>
</div>

</div>

<div id="doc" role="main"><h2 id="Submission Instructions" class="section">Submission Instructions<a class="anchor" href="#Submission Instructions" title="permalink to this section"><i class="fas fa-link"></i></a></h2><p>Similar to the <a class="xref" hyphens="none" href="/resources/haskell-01.html#Submission Instructions">previous assignment</a>—you must submit a <strong>single Haskell file</strong> with the following template.</p><div paragraphs="none" smart-typography="none" class="highlight"><div class="caption">Assignment02.hs<button class="download-button" title="Download snippet as Assignment02.hs" onclick="download(this, `Assignment02.hs`, String.raw`module Assignment02 where

-----------------------------------------------------------
-- QUESTION 1


-----------------------------------------------------------
-- QUESTION 2


-----------------------------------------------------------
-- QUESTION 3


-----------------------------------------------------------
-- QUESTION 4

{-
  Write your answer as a comment here.
-}`)"><i class="fa fa-download"></i></button></div><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`module Assignment02 where

-----------------------------------------------------------
-- QUESTION 1


-----------------------------------------------------------
-- QUESTION 2


-----------------------------------------------------------
-- QUESTION 3


-----------------------------------------------------------
-- QUESTION 4

{-
  Write your answer as a comment here.
-}`)"><i class="fas fa-copy"></i></button><pre><code>module Assignment02 where

-----------------------------------------------------------
-- QUESTION 1


-----------------------------------------------------------
-- QUESTION 2


-----------------------------------------------------------
-- QUESTION 3


-----------------------------------------------------------
-- QUESTION 4

{-
  Write your answer as a comment here.
-}</code></pre></div><p>You can download the template using the <i class="fa fa-download" style="position: relative; margin: 0 0.1em 0 0.1em; top: -0.05em; font-size: 0.9em; color: var(--muted-color);"></i> button next to the file name. You can also copy any code snippet by hovering over it and clicking the <i class="fa fa-copy" style="margin: 0 0.1em 0 0.1em; color: var(--muted-color);"></i> button which appears on the top right.</p><div class="callout" data-callout="warning"><div class="callout-title">Warning</div><div class="callout-body"><p>Your file name and module name <em>must</em> match the template—any other file or module name will be rejected.</p><p>You may <em>not</em> use any imports to solve this lab. If your file contains an import statement, you will get zero marks.</p></div></div><hr/><h2 id="Question 1" class="section">Question 1<a class="anchor" href="#Question 1" title="permalink to this section"><i class="fas fa-link"></i></a></h2><p>Write a function which accepts a list of directions and uses that list to update the position of a point in space. Here is an example of how it should work.</p><div paragraphs="none" smart-typography="none" class="highlight"><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`ghci&gt; receiveAndProc
L L L L L U U U D R U  # user input
(-4,3)`)"><i class="fas fa-copy"></i></button><pre><code>ghci&gt; receiveAndProc
L L L L L U U U D R U  # user input
(-4,3)</code></pre></div><p>Use the following template.</p><div paragraphs="none" smart-typography="none" class="highlight"><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`-- Represents a direction: left, right, up, down.
data Direction = L | R | U | D
  deriving (Show, Read)

-- Represents a position on a grid.
type Position = (Int, Int)

-- This is where the main work should happen.
-- Examples:
--   process [L,L,L,U,U] (0,0) == (-3,2)
--   process [L,R,U,U,D,R] (1,-1) == (2,0)
process :: [Direction] -&gt; Position -&gt; Position
process = undefined

-- This should read a space-separated list of directions
-- and determine the new position of the point (0,0).
receiveAndProc :: IO ()
receiveAndProc = do
  undefined`)"><i class="fas fa-copy"></i></button><pre><code>-- Represents a direction: left, right, up, down.
data Direction = L | R | U | D
  deriving (Show, Read)

-- Represents a position on a grid.
type Position = (Int, Int)

-- This is where the main work should happen.
-- Examples:
--   process [L,L,L,U,U] (0,0) == (-3,2)
--   process [L,R,U,U,D,R] (1,-1) == (2,0)
process :: [Direction] -&gt; Position -&gt; Position
process = undefined

-- This should read a space-separated list of directions
-- and determine the new position of the point (0,0).
receiveAndProc :: IO ()
receiveAndProc = do
  undefined</code></pre></div><p>You will find the following functions useful.</p><div paragraphs="none" smart-typography="none" class="highlight"><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`-- Simple parsing for ‘readable’ types. If Haskell can’t
-- infer what the return type is from context, you will
-- need to provide it like this:
--    read @Int :: String -&gt; Int
--    read @Direction :: String -&gt; Direction
-- The @-symbol is, in this context, a ‘type application’
-- operator — it specialises the type signature to a type
-- that implements the Read typeclass.
read :: Read a =&gt; String -&gt; a

-- Splits a string by whitespace.
-- Example:
--   words &quot;1 2\n3&quot; == [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;]
words :: String -&gt; [String]

-- Applies a function to each of the elements of a list.
-- Example:
--   map (+1) [1,2,3] == [2,3,4]
map :: (a -&gt; b) -&gt; [a] -&gt; [b]`)"><i class="fas fa-copy"></i></button><pre><code>-- Simple parsing for ‘readable’ types. If Haskell can’t
-- infer what the return type is from context, you will
-- need to provide it like this:
--    read @Int :: String -&gt; Int
--    read @Direction :: String -&gt; Direction
-- The @-symbol is, in this context, a ‘type application’
-- operator — it specialises the type signature to a type
-- that implements the Read typeclass.
read :: Read a =&gt; String -&gt; a

-- Splits a string by whitespace.
-- Example:
--   words "1 2\n3" == ["1", "2", "3"]
words :: String -&gt; [String]

-- Applies a function to each of the elements of a list.
-- Example:
--   map (+1) [1,2,3] == [2,3,4]
map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code></pre></div><h2 id="Question 2" class="section">Question 2<a class="anchor" href="#Question 2" title="permalink to this section"><i class="fas fa-link"></i></a></h2><p>Recall the following data type from the lectures.</p><div paragraphs="none" smart-typography="none" class="highlight"><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`data SimpleIO a
  = Put String (SimpleIO a)
  | Get (String -&gt; SimpleIO a)
  | Return a`)"><i class="fas fa-copy"></i></button><pre><code>data SimpleIO a
  = Put String (SimpleIO a)
  | Get (String -&gt; SimpleIO a)
  | Return a</code></pre></div><p>Write a function</p><div paragraphs="none" smart-typography="none" class="highlight"><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`exclaim :: SimpleIO a -&gt; SimpleIO a
exclaim = undefined`)"><i class="fas fa-copy"></i></button><pre><code>exclaim :: SimpleIO a -&gt; SimpleIO a
exclaim = undefined</code></pre></div><p>which takes a <code>SimpleIO</code> computation and appends an exclamation mark to every string that is <code>Put</code>. To test this, you will need the following:</p><div paragraphs="none" smart-typography="none" class="highlight"><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`io :: SimpleIO a -&gt; IO a
io computation =
  case computation of
    Put s rest -&gt; do
      putStrLn s
      io rest

    Get k -&gt; do
      s &lt;- getLine
      io (k s)

    Return a -&gt;
      return a

example :: SimpleIO ()
example =
  Put &quot;Hello&quot; $
  Get $ \name -&gt;
  Put (&quot;My name is &quot; ++ name) $
  Return ()`)"><i class="fas fa-copy"></i></button><pre><code>io :: SimpleIO a -&gt; IO a
io computation =
  case computation of
    Put s rest -&gt; do
      putStrLn s
      io rest

    Get k -&gt; do
      s &lt;- getLine
      io (k s)

    Return a -&gt;
      return a

example :: SimpleIO ()
example =
  Put "Hello" $
  Get $ \name -&gt;
  Put ("My name is " ++ name) $
  Return ()</code></pre></div><p>For example:</p><div paragraphs="none" smart-typography="none" class="highlight"><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`ghci&gt; io example
Hello
Conor  # user input
My name is Conor

ghci&gt; io (exclaim example)
Hello!
Conor  # user input
My name is Conor!`)"><i class="fas fa-copy"></i></button><pre><code>ghci&gt; io example
Hello
Conor  # user input
My name is Conor

ghci&gt; io (exclaim example)
Hello!
Conor  # user input
My name is Conor!</code></pre></div><h2 id="Question 3" class="section">Question 3<a class="anchor" href="#Question 3" title="permalink to this section"><i class="fas fa-link"></i></a></h2><p>Traditionally, monads are triples</p><div class="display-math" hyphens="none" paragraphs="none" smart-typography="none">\[\begin{aligned}
  \langle M, \; \eta : 1 \to M, \; \mu : M^2 \to M \rangle
\end{aligned}\]</div><p>You are already familiar with <span class="inline-math" hyphens="none" smart-typography="none">\(\eta\)</span>—that’s <code>return</code> in Haskell. But <span class="inline-math" hyphens="none" smart-typography="none">\(\mu\)</span> is unfamiliar. In Haskell it is called <a class="extlink" href="https://www.stackage.org/haddock/lts-20.15/base-4.16.4.0/Control-Monad.html#v:join"><code>join</code></a>, and has the type <code>Monad m =&gt; m (m a) -&gt; m a</code>. It is possible—and sometimes easier—to define a monad in terms of <code>join</code> instead of <code>(&gt;&gt;=)</code>.</p><p>Provide a monad instance for the type <code>Arrow r</code> by defining <code>return</code> and <code>join</code>, where <code>join</code> is called <code>arrowJoin</code>, by replacing each <code>undefined</code> with working code. <span class="tooltip" role="button" aria-expanded="false" tabindex="0" onclick="this.classList.toggle(&quot;show-tooltip&quot;); toggleAriaExpanded(this);"><i class="fa fa-plus"></i><span class="tooltip-inner">If, for some reason, you are running an older version of Haskell, you may need to explicitly enable the Generalized­Newtype­Deriving language extension.</span></span></p><div paragraphs="none" smart-typography="none" class="highlight"><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`newtype Arrow r a = Arrow { apply :: r -&gt; a }
  deriving (Functor, Applicative)

instance Monad (Arrow r) where
  return a = undefined
  m &gt;&gt;= f = arrowJoin (fmap f m)

arrowJoin :: Arrow r (Arrow r a) -&gt; Arrow r a
arrowJoin arrow = undefined`)"><i class="fas fa-copy"></i></button><pre><code>newtype Arrow r a = Arrow { apply :: r -&gt; a }
  deriving (Functor, Applicative)

instance Monad (Arrow r) where
  return a = undefined
  m &gt;&gt;= f = arrowJoin (fmap f m)

arrowJoin :: Arrow r (Arrow r a) -&gt; Arrow r a
arrowJoin arrow = undefined</code></pre></div><h2 id="Question 4 (Hard)" class="section">Question 4 (Hard)<a class="anchor" href="#Question 4 (Hard)" title="permalink to this section"><i class="fas fa-link"></i></a></h2><p>Prove that the monad instance you defined in <a class="xref" hyphens="none" href="#Question 3">Question 3</a> satisfies the following monad law: <span class="tooltip" role="button" aria-expanded="false" tabindex="0" onclick="this.classList.toggle(&quot;show-tooltip&quot;); toggleAriaExpanded(this);"><i class="fa fa-plus"></i><span class="tooltip-inner">Note that <code>(.)</code> is function composition, which is defined <code>g . f = \x -&gt; g (f x)</code>, and <code>id</code> is the identity function, defined by <code>id x = x</code>.</span></span></p><div paragraphs="none" smart-typography="none" class="highlight"><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`join . return = id`)"><i class="fas fa-copy"></i></button><pre><code>join . return = id</code></pre></div><p>In practice, this means that, for an arbitrary <code>x :: Arrow r a</code>, you should show the following:</p><div paragraphs="none" smart-typography="none" class="highlight"><button class="copy-button" title="Copy snippet to clipboard" onclick="copyAndConfirm(this, String.raw`arrowJoin (return x) = x`)"><i class="fas fa-copy"></i></button><pre><code>arrowJoin (return x) = x</code></pre></div><p>Write this proof as a comment in your Haskell file.</p></div>





<div class="horizontal-rule"></div>

<div id="footer">© <a class="name" href="/">Conor Reynolds</a>
  2022–2025  
<a class="fab fa-orcid fa-1x" href="https://orcid.org/0000-0002-6598-5512" title="ORCID"></a>  
<a class="fab fa-github fa-1x" href="https://github.com/ConorReynolds" title="GitHub"></a>  
<a class="fab fa-twitter fa-1x" href="https://twitter.com/ConorEReynolds" title="Twitter"></a>  
<a class="fab fa-linkedin-in fa-1x" href="https://www.linkedin.com/in/conor-reynolds-931049258/" title="LinkedIn"></a>  
<a class="fas fa-envelope fa-1x" href="mailto:conor.reynolds@manchester.ac.uk" title="Email"></a></div>
</body>

<script src="/js/utils.js"></script>
<script src="/js/checkParams.js"></script>



</html>