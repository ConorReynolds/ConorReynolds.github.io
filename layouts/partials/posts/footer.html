<div class="horizontal-rule"></div>
<div id="footer">
    {{ if .Site.Params.socialIcons }}
    <div class="footer-bar">
        {{ range $item := .Site.Params.socialIcons }}
        <a href="{{ $item.url }}" class="{{ $item.icon }} fa-1x" title="{{ $item.title }}"></a>
        &nbsp;
        {{ end }}

        <noscript>
            <a href='https://ko-fi.com/B0B3CTXXW' target='_blank'><img height='36' style='border:0px;height:36px;'
                    src='https://cdn.ko-fi.com/cdn/kofi5.png?v=3' alt='support me at ko-fi'></a>
        </noscript>

        <script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script>
        <script type='text/javascript'>
            let darkColor = getComputedStyle(document.querySelector(':root')).getPropertyValue('--main-black-color');
            let lightColor = getComputedStyle(document.querySelector(':root')).getPropertyValue('--main-gray-color');
            let bgColors = [lightColor, darkColor];
            let borderColors = ["rgba(0,0,0,0.8)", "rgba(0,0,0,0.2)"];

            let idx = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
                ? 0
                : 1;

            kofiwidget2.init('support me on ko-fi', bgColors[idx], 'B0B3CTXXW');
            kofiwidget2.draw();

            // watch for color-scheme changes
            window.matchMedia(`(prefers-color-scheme: dark)`).addListener(function (event) {
                idx = (idx + 1) % 2;
                let kofiButton = document.querySelector('a.kofi-button');
                kofiButton.style.setProperty('background-color', bgColors[idx]);
                kofiButton.style.setProperty('box-shadow', `1px 1px 0px ${borderColors[idx]}`);

            });
        </script>
    </div>
    {{ end }}
    {{ with .Site.Params.footer }}
    <div id="copyright">
        <small>{{ .text }}</small>
    </div>
    {{ end }}
</div>

{{ $ts := resources.Get "ts/font-size.ts" | js.Build }}
<script src="{{ $ts.RelPermalink }}" defer></script>

{{ $ts := resources.Get "ts/tweaks.ts" | js.Build }}
<script src="{{ $ts.RelPermalink }}" defer></script>